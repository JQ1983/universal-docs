---
description: PowerShell Protect integration for PowerShell Universal.
---

# PowerShell Protect

PowerShell Protect is a feature of PowerShell Pro Tools. It allows you to audit and block PowerShell scripts and PowerShell command lines that are executed on your machine. You can deploy the client piece and then configure it using PowerShell Universal. PowerShell Universal can also be used as a collection mechanism for events generated by PowerShell Protect. Additionally, PowerShell Universal can trigger scripts when certain rules are triggered.&#x20;

You can access PowerShell Protect tooling by navigating to Security \ Protect.&#x20;

![](<../../.gitbook/assets/image (326).png>)

## Configuring PowerShell Protect

PowerShell Protect is configured via XML. PowerShell Universal can be used to create this XML. Navigate to the PowerShell Protect page and then click Configurations. Click Create New Configuration and name the configuration you are creating.&#x20;

![](<../../.gitbook/assets/image (418).png>)

### Default Rules

Default rules are configured that will block certain behaviors without additional configuration. You can choose to disable any rules you may not desire to enforce.&#x20;

![](<../../.gitbook/assets/image (348).png>)

### Actions&#x20;

Actions are the result of custom rules triggering based on scripts being run. You can take actions such as blocking the script, sending the event to the event log or sending the event to PowerShell Universal.&#x20;

![](<../../.gitbook/assets/image (343).png>)

Depending on the action selected, you will need to include additional settings. For example, to integrate with PowerShell Universal, you will need to define the HTTP address of the PSU server and an app token used to authenticate against PSU.&#x20;

![](<../../.gitbook/assets/image (339).png>)

### Custom Rules&#x20;

Custom rules can be defined to match features of a script being run. For example, you can match the user, script content, variables and domain being used to run a script. If the custom rule matches, you can then execute one or more rules that you have defined.&#x20;

![](<../../.gitbook/assets/image (338).png>)

## Installing a PowerShell Protect Config

Once you have completed your configuration, you can navigate back to the Configurations page and download the XML.&#x20;

![](<../../.gitbook/assets/image (302).png>)

You can learn how to install PowerShell Protect configurations [here](https://docs.poshtools.com/powershell-pro-tools-documentation/powershell-protect/configuration).&#x20;
